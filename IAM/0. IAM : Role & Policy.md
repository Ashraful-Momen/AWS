ржЪрж▓рзБржи рж╕рж╣ржЬржнрж╛ржмрзЗ **AWS IAM Role & Policy** ржмрзБржЭрж┐ тАФ ржмрж╛ржВрж▓рж╛рзЯ ржмрзНржпрж╛ржЦрзНржпрж╛ + ASCII ржбрж╛рзЯрж╛ржЧрзНрж░рж╛ржорж╕рж╣ ЁЯСЗ

---

## ЁЯзй **1я╕ПтГг IAM User, Role, Policy ржХрзАржнрж╛ржмрзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд**

ржкрзНрж░ржержорзЗ ржмрзЬ ржЪрж┐рждрзНрж░ржЯрж╛ ржжрзЗржЦрж┐:

```
+-------------------------------+
|        AWS Account            |
|-------------------------------|
|   +-----------------------+   |
|   |     IAM User          |   |   <-- рж▓ржЧржЗржи ржХрж░рзЗ ржХрж╛ржЬ ржХрж░рзЗ (Access key ржмрж╛ Console)
|   +-----------------------+   |
|             |                 |
|             | attached        |
|             v                 |
|   +-----------------------+   |
|   |      Policy           |   |   <-- ржХрзЛржи ржХрж╛ржЬ (Action) ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржЖржЫрзЗ ржмрж▓рзЗ
|   |   (JSON Permission)   |   |       define ржХрж░рзЗ
|   +-----------------------+   |
|             ^                 |
|             |                 |
|   +-----------------------+   |
|   |       IAM Role        |   |   <-- EC2/S3/Lambda ржПрж░ ржорждрзЛ services
|   |  (acts like a user)   |   |       temporary permission ржирзЗрзЯ
|   +-----------------------+   |
+-------------------------------+
```

---

## ЁЯзн **2я╕ПтГг Role ржХрзА (Role = Temporary Identity)**

ЁЯСЙ **Role** рж╣рж▓рзЛ ржПржХ ржзрж░ржирзЗрж░ "virtual user" тАФ ржпрж╛ржХрзЗ AWS service (ржпрзЗржоржи EC2, Lambda) **temporary credential** ржжрж┐рзЯрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж╛ржЬ ржХрж░рждрзЗ ржжрзЗрзЯред

ЁЯза ржЙржжрж╛рж╣рж░ржг:
ржзрж░рж╛ ржпрж╛ржХ, рждрзБржорж┐ ржПржХржЯрж╛ EC2 instance ржЪрж╛рж▓рж╛ржУ ржпрзЗржЯрж╛ржХрзЗ рждрзБржорж┐ S3 bucket-ржП file upload ржХрж░рждрзЗ ржжрж┐рждрзЗ ржЪрж╛ржУред
рждрзБржорж┐ EC2 instance-ржП Access key ржжрж┐рждрзЗ ржкрж╛рж░рзЛ тАФ ржХрж┐ржирзНрждрзБ ржПржЯрж╛ risky тЭМ
рждрж╛ржЗ рждрзБржорж┐ **Role attach ржХрж░рзЛ** тАФ ржпрж╛рждрзЗ EC2 instance ржирж┐ржЬрзЗ ржирж┐ржЬрзЗ S3 рждрзЗ access ржирж┐рждрзЗ ржкрж╛рж░рзЗ тЬЕ

```
+------------------+          +-----------------+
| EC2 Instance     |  ----->  |  IAM Role       |
| (no keys needed) |          |  S3AccessRole   |
+------------------+          +-----------------+
                                    |
                                    v
                           +------------------+
                           |   Policy         |
                           |  Allow S3 CRUD   |
                           +------------------+
```

---

## ЁЯФР **3я╕ПтГг Policy ржХрзА (Policy = Permission Rules)**

**Policy** рж╣рж▓рзЛ ржПржХ ржзрж░ржирзЗрж░ JSON ржлрж╛ржЗрж▓, ржпрж╛ ржмрж▓рзЗ ржжрзЗрзЯ тАФ
**ржХрзЗ (User/Role)**, **ржХрзЛржи Resource-ржП**, **ржХрж┐ Action** ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред

ЁЯз╛ ржЙржжрж╛рж╣рж░ржг тАФ S3 Full Access Policy (Custom Policy):

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:*",
      "Resource": "*"
    }
  ]
}
```

ржПржЗ policy ржпржжрж┐ **EC2Role** ржП attach ржХрж░рж╛ рж╣рзЯ,
рждрж╛рж╣рж▓рзЗ EC2 instance-ржПрж░ ржнрж┐рждрж░ ржерзЗржХрзЗ S3 рждрзЗ create/read/update/delete рж╕ржм ржХрж░рж╛ ржпрж╛ржмрзЗред

---

## тЪЩя╕П **4я╕ПтГг Role vs Policy vs User рждрзБрж▓ржирж╛**

| ржмрж┐рж╖рзЯ       | ржмрж░рзНржгржирж╛                                            | ржЙржжрж╛рж╣рж░ржг                   |
| ---------- | ------------------------------------------------- | ------------------------ |
| **User**   | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржмрзНржпржХрзНрждрж┐ ржмрж╛ ржЕрзНржпрж╛ржк                        | `dev_user`, `admin_user` |
| **Role**   | temporary identity (for service or cross-account) | `EC2_S3Access_Role`      |
| **Policy** | JSON permission rule                              | `AmazonS3FullAccess`     |

---

## ЁЯкЬ **5я╕ПтГг ржЫрзЛржЯ ржЙржжрж╛рж╣рж░ржг (S3 CRUD Step Flow)**

```
[1] Create S3 bucket  ---> my-bucket-demo
[2] Create Policy ----> Allow s3:ListBucket, s3:GetObject, s3:PutObject
[3] Create Role -----> Attach Policy
[4] Attach Role to EC2
[5] EC2 Instance now can:
        - aws s3 ls
        - aws s3 cp file.txt s3://my-bucket-demo/
        - aws s3 rm s3://my-bucket-demo/file.txt
```

```
EC2 ---> Role ---> Policy ---> S3
```

---

## ЁЯза **рж╕рж╣ржЬ ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржХрзМрж╢рж▓:**

> **User** = "ржЖржорж┐"
> **Role** = "ржЕржирзНржп ржХрж╛рж░рзЛ рж╣рзЯрзЗ ржХрж╛ржЬ ржХрж░рж╛ ржорж╛рж╕рзНржХ" ЁЯШ╖
> **Policy** = "ржирж┐рзЯржорзЗрж░ ржмржЗ ЁЯУЬ"

---

